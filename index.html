<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Airport Guide | The Professional's Flight Companion</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        html { scroll-behavior: smooth; }
        
        /* Gradients */
        .hero-bg {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            position: relative;
            overflow: hidden;
        }
        .hero-bg::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(circle at 70% 30%, rgba(99, 102, 241, 0.15) 0%, transparent 50%);
        }
        
        /* App Specific Styles */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        
        /* Transitions */
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Modal & Loaders */
        .modal { transition: opacity 0.25s ease; }
        body.modal-active { overflow: hidden; }
        
        .loader {
            border-top-color: #4f46e5;
            -webkit-animation: spinner 1.5s linear infinite;
            animation: spinner 1.5s linear infinite;
        }
        @keyframes spinner { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .check-list li { position: relative; padding-left: 1.5rem; margin-bottom: 0.75rem; }
        .check-list li::before { content: '\f00c'; font-family: 'Font Awesome 6 Free'; font-weight: 900; color: #4f46e5; position: absolute; left: 0; top: 2px; }
    </style>
</head>
<body class="text-slate-800 bg-white">

    <!-- ==================== 1. LOGIN MODAL ==================== -->
    <div id="landingLoginModal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity" onclick="closeLoginModal()"></div>
        <div class="bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden relative z-10 fade-in transform transition-all mx-4">
            <button onclick="closeLoginModal()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 p-2"><i class="fas fa-times text-xl"></i></button>
            <div class="p-6 sm:p-8 text-center">
                <div class="w-14 h-14 bg-indigo-600 rounded-xl flex items-center justify-center text-white text-2xl mx-auto mb-6 shadow-lg shadow-indigo-500/30"><i class="fas fa-plane-departure"></i></div>
                <h2 class="text-2xl font-bold text-slate-900 mb-2">Welcome Back</h2>
                <p class="text-slate-500 mb-6 text-sm">Access the professional flight network.</p>
                <form onsubmit="handleLogin(event)" class="space-y-4 text-left">
                    <div><label class="block text-xs font-bold text-slate-500 uppercase mb-1">Email</label><input type="email" value="user@business.com" class="w-full px-4 py-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-indigo-500 outline-none transition text-sm" required></div>
                    <div><label class="block text-xs font-bold text-slate-500 uppercase mb-1">Password</label><input type="password" value="password" class="w-full px-4 py-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-indigo-500 outline-none transition text-sm" required></div>
                    <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg shadow-md transition transform active:scale-[0.98]">Log In</button>
                </form>
                <p class="mt-6 text-xs text-slate-400">v2.9.0 â€¢ Full Airline Names</p>
            </div>
        </div>
    </div>

    <!-- ==================== 2. LANDING PAGE VIEW ==================== -->
    <div id="landingView">
        <nav class="fixed w-full z-50 bg-white/90 backdrop-blur-md border-b border-slate-100">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex items-center gap-2">
                        <div class="bg-indigo-600 p-2 rounded-lg text-white"><i class="fas fa-plane-departure"></i></div>
                        <span class="font-bold text-lg sm:text-xl tracking-tight text-slate-900">Airport Guide</span>
                    </div>
                    <div class="hidden md:flex items-center space-x-8 text-sm font-medium text-slate-600">
                        <a href="#features" class="hover:text-indigo-600 transition">Features</a>
                        <a href="#pricing" class="hover:text-indigo-600 transition">Pricing</a>
                    </div>
                    <button onclick="openLoginModal()" class="bg-slate-900 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-slate-800 transition">Sign In</button>
                </div>
            </div>
        </nav>

        <section class="hero-bg pt-28 pb-16 lg:pt-48 lg:pb-32 text-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                <div class="grid lg:grid-cols-2 gap-8 lg:gap-12 items-center">
                    <div class="text-center lg:text-left">
                        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-500/20 border border-indigo-500/30 text-indigo-300 text-xs font-semibold mb-6">
                            <span class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></span> Live Data V2.0 Available
                        </div>
                        <h1 class="text-3xl sm:text-5xl lg:text-6xl font-extrabold tracking-tight leading-tight mb-6">The flight data <br><span class="text-indigo-400">professionals trust.</span></h1>
                        <p class="text-base sm:text-lg text-slate-300 mb-8 leading-relaxed max-w-lg mx-auto lg:mx-0">Navigate the world's busiest hubs with confidence. Airport Guide aggregates official flight data to give you clear, actionable updates directly on your device.</p>
                        <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
                            <button onclick="openLoginModal()" class="px-8 py-4 bg-indigo-600 rounded-lg font-bold text-center hover:bg-indigo-500 transition shadow-lg shadow-indigo-600/25">Start Free Trial</button>
                            <a href="#features" class="px-8 py-4 bg-slate-800 rounded-lg font-bold text-center hover:bg-slate-700 transition border border-slate-700">See How It Works</a>
                        </div>
                    </div>
                    <div class="relative hidden lg:block">
                        <div class="absolute -inset-1 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl blur opacity-30"></div>
                        <div class="relative bg-slate-900 border border-slate-800 rounded-2xl shadow-2xl overflow-hidden p-6">
                            <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-xl border border-slate-700/50 mb-4">
                                <div><div class="text-2xl font-bold font-mono">14:15</div><div class="text-xs text-slate-400">Scheduled</div></div>
                                <div class="text-right"><div class="text-indigo-400 font-bold">LHR <i class="fas fa-arrow-right mx-1"></i> JFK</div><div class="text-xs text-slate-400">Terminal 5 / Gate B34</div></div>
                            </div>
                            <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-xl border border-slate-700/50">
                                <div><div class="text-2xl font-bold font-mono text-yellow-500">16:45</div><div class="text-xs text-slate-400 line-through">16:10</div></div>
                                <div class="text-right"><div class="text-indigo-400 font-bold">CPH <i class="fas fa-arrow-right mx-1"></i> ORD</div><div class="text-xs text-slate-400 text-yellow-500">Delayed (+35m)</div></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features & Pricing -->
        <section id="features" class="py-16 lg:py-24 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center max-w-3xl mx-auto mb-12 lg:mb-16"><h2 class="text-indigo-600 font-semibold uppercase tracking-wide text-sm mb-2">Why Upgrade?</h2><h3 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-4">One Dashboard for Every Connection</h3><p class="text-slate-600 text-sm sm:text-base">Stop juggling different airport websites and confusing local apps.</p></div>
                <div class="grid md:grid-cols-3 gap-6 lg:gap-8">
                    <div class="p-6 sm:p-8 rounded-2xl bg-slate-50 border border-slate-100 hover:shadow-lg transition"><h4 class="text-lg sm:text-xl font-bold text-slate-900 mb-3">Accessible Gate Data</h4><p class="text-slate-600 text-sm">View gate assignments instantly on your phone.</p></div>
                    <div class="p-6 sm:p-8 rounded-2xl bg-slate-50 border border-slate-100 hover:shadow-lg transition"><h4 class="text-lg sm:text-xl font-bold text-slate-900 mb-3">Clear Status Monitoring</h4><p class="text-slate-600 text-sm">See exact delays.</p></div>
                    <div class="p-6 sm:p-8 rounded-2xl bg-slate-50 border border-slate-100 hover:shadow-lg transition"><h4 class="text-lg sm:text-xl font-bold text-slate-900 mb-3">The Power 10 Network</h4><p class="text-slate-600 text-sm">High-fidelity coverage for critical business hubs.</p></div>
                </div>
            </div>
        </section>

        <section id="pricing" class="py-16 lg:py-24 bg-slate-900 text-white relative overflow-hidden">
            <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10"></div>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                <div class="text-center mb-12 lg:mb-16"><h2 class="text-2xl sm:text-3xl font-bold mb-4">Simple, Transparent Pricing</h2><p class="text-slate-400 text-sm sm:text-base">Expense it to your company or invest in your own peace of mind.</p></div>
                <div class="grid md:grid-cols-3 gap-6 lg:gap-8 max-w-5xl mx-auto items-center">
                    <div class="bg-slate-800 rounded-2xl p-6 sm:p-8 border border-slate-700 hover:border-slate-600 transition order-2 md:order-1">
                        <h3 class="text-lg font-semibold text-slate-300">Monthly</h3>
                        <div class="my-4 flex items-baseline"><span class="text-4xl font-bold text-white">$8.99</span><span class="text-slate-400 ml-2">/mo</span></div>
                        <button onclick="openLoginModal()" class="block w-full py-3 text-center rounded-lg border border-slate-600 hover:bg-slate-700 font-semibold transition">Select Plan</button>
                    </div>
                    <div class="bg-indigo-600 rounded-2xl p-6 sm:p-8 border border-indigo-500 transform md:scale-105 shadow-2xl relative order-1 md:order-2">
                        <div class="absolute top-0 right-0 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-bl-lg rounded-tr-lg">BEST VALUE</div>
                        <h3 class="text-lg font-semibold text-indigo-100">Annual</h3>
                        <div class="my-4 flex items-baseline"><span class="text-5xl font-bold text-white">$59.99</span><span class="text-indigo-200 ml-2">/yr</span></div>
                        <p class="text-sm text-indigo-100 mb-6 opacity-90">Equivalent to <strong>$4.99/mo</strong>.</p>
                        <button onclick="openLoginModal()" class="block w-full py-3 text-center rounded-lg bg-white text-indigo-700 font-bold hover:bg-indigo-50 transition shadow-lg">Start Free Trial</button>
                    </div>
                    <div class="bg-slate-800 rounded-2xl p-6 sm:p-8 border border-slate-700 hover:border-slate-600 transition order-3">
                        <h3 class="text-lg font-semibold text-slate-300">6 Months</h3>
                        <div class="my-4 flex items-baseline"><span class="text-4xl font-bold text-white">$39.99</span><span class="text-slate-400 ml-2">/6mo</span></div>
                        <button onclick="openLoginModal()" class="block w-full py-3 text-center rounded-lg border border-slate-600 hover:bg-slate-700 font-semibold transition">Select Plan</button>
                    </div>
                </div>
            </div>
        </section>
        <footer class="bg-white border-t border-slate-100 py-12"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center gap-6"><div class="flex items-center gap-2"><div class="bg-slate-900 p-1.5 rounded text-white text-xs"><i class="fas fa-plane-departure"></i></div><span class="font-bold text-slate-900">Airport Guide</span></div><div class="text-slate-500 text-sm">&copy; 2025 Airport Guide. All rights reserved.</div></div></footer>
    </div>

    <!-- ==================== 3. APP CONTAINER VIEW ==================== -->
    <div id="appContainer" class="hidden h-[100dvh] overflow-hidden flex flex-col bg-slate-50 text-slate-800">
        
        <!-- Desktop Sidebar -->
        <div id="appLayout" class="flex h-full w-full">
            <aside class="w-64 bg-slate-900 text-white hidden md:flex flex-col flex-shrink-0">
                <div class="p-6 border-b border-slate-800 flex items-center gap-3"><div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-sm"><i class="fas fa-plane"></i></div><span class="font-bold text-lg tracking-tight">Airport Guide</span></div>
                <nav class="flex-1 p-4 space-y-2">
                    <button onclick="navTo('dashboard')" id="nav-dashboard" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg bg-indigo-600 text-white font-medium transition"><i class="fas fa-th-large w-5 text-center"></i> Dashboard</button>
                    <button onclick="navTo('flights')" id="nav-flights" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-slate-800 hover:text-white transition"><i class="fas fa-list w-5 text-center"></i> Flight Board</button>
                    <button onclick="navTo('settings')" id="nav-settings" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-slate-800 hover:text-white transition"><i class="fas fa-cog w-5 text-center"></i> Settings</button>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 flex flex-col h-full overflow-hidden bg-slate-50 relative">
                <!-- Mobile Header -->
                <header class="md:hidden bg-slate-900 text-white p-4 flex items-center justify-between shadow-md z-10 flex-shrink-0">
                    <div class="flex items-center gap-2"><div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-sm"><i class="fas fa-plane"></i></div><span class="font-bold text-lg">Airport Guide</span></div>
                </header>

                <div class="flex-1 overflow-y-auto p-4 md:p-8 app-scroll w-full pb-24" id="mainContent">
                    <!-- VIEW: DASHBOARD -->
                    <div id="view-dashboard" class="max-w-5xl mx-auto fade-in w-full">
                        <h2 class="text-xl sm:text-2xl font-bold text-slate-900 mb-2">Network Status</h2>
                        <p class="text-slate-500 mb-6 text-sm">Select a hub to view live gate and schedule data.</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 pb-20 md:pb-0" id="dashboardGrid"></div>
                    </div>

                    <!-- VIEW: FLIGHT BOARD -->
                    <div id="view-flights" class="hidden h-full flex flex-col w-full">
                        <div class="flex flex-col sm:flex-row justify-between mb-4 flex-shrink-0 gap-3">
                            <div>
                                <h2 class="text-xl sm:text-2xl font-bold text-slate-900 flex items-center gap-2 flex-wrap"><span id="boardTitle">Select Airport</span><span class="text-sm px-2 py-1 bg-slate-200 rounded text-slate-600 font-mono" id="boardCode">---</span></h2>
                                <p class="text-sm text-slate-500" id="boardTime">Updated: Just now</p>
                            </div>
                            <div class="flex gap-2"><button onclick="refreshData()" class="flex-1 sm:flex-none bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 px-4 py-2 rounded-lg text-sm font-medium shadow-sm transition"><i class="fas fa-sync-alt mr-1"></i> Refresh</button><button onclick="navTo('dashboard')" class="md:hidden bg-slate-200 text-slate-600 px-4 py-2 rounded-lg text-sm font-medium">Back</button></div>
                        </div>
                        <div class="flex border-b border-slate-200 mb-0 flex-shrink-0"><button onclick="switchFlightTab('departures')" id="tab-departures" class="flex-1 sm:flex-none px-6 py-3 text-sm font-bold text-indigo-600 border-b-2 border-indigo-600 transition text-center">Departures</button><button onclick="switchFlightTab('arrivals')" id="tab-arrivals" class="flex-1 sm:flex-none px-6 py-3 text-sm font-bold text-slate-500 border-b-2 border-transparent hover:text-indigo-600 transition text-center">Arrivals</button></div>
                        <div class="bg-white rounded-b-xl border border-t-0 border-slate-200 shadow-sm flex-1 overflow-hidden relative mb-20 md:mb-0 min-h-[300px]">
                            <div id="loadingOverlay" class="absolute inset-0 bg-white/80 z-10 flex items-center justify-center hidden"><div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4"></div></div>
                            <div class="h-full w-full" id="flightTableContainer"><div class="p-12 text-center text-slate-400"><i class="fas fa-plane-departure text-4xl mb-4 opacity-20"></i><p>Select an airport from the Dashboard.</p></div></div>
                        </div>
                    </div>

                    <!-- VIEW: SETTINGS -->
                    <div id="view-settings" class="hidden max-w-2xl mx-auto w-full">
                        <h2 class="text-xl sm:text-2xl font-bold text-slate-900 mb-6">Settings</h2>
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
                            <h3 class="font-bold text-lg mb-4">Data Source</h3>
                            <div class="space-y-4">
                                <div><label class="block text-sm font-medium text-slate-700 mb-1">AirLabs API Key</label><input type="text" id="settingApiKey" value="6dbc8e13-9a88-4994-9c2c-107dbe6bf103" class="w-full px-3 py-2 border border-slate-300 rounded-md text-sm font-mono text-slate-600"></div>
                                <div class="flex items-center justify-between py-2"><div><div class="text-sm font-medium text-slate-900">Demo Mode</div><div class="text-xs text-slate-500">Fill missing data</div></div><label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" id="settingDemoMode" class="sr-only peer"><div class="w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div></label></div>
                                <div class="flex items-center justify-between py-2"><div><div class="text-sm font-medium text-slate-900">Hide Past Flights</div><div class="text-xs text-slate-500">Only show active</div></div><label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" id="settingHidePast" class="sr-only peer" checked><div class="w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div></label></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6"><button onclick="backToLanding()" class="text-red-500 text-sm font-bold hover:underline">Log Out</button></div>
                    </div>
                </div>

                <nav class="md:hidden bg-white border-t border-slate-200 flex justify-around p-2 text-xs font-medium text-slate-500 flex-shrink-0 z-20 absolute bottom-0 w-full shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
                    <button onclick="navTo('dashboard')" id="mobile-dashboard" class="flex flex-col items-center gap-1 p-2 text-indigo-600 w-full"><i class="fas fa-th-large text-lg"></i> Home</button>
                    <button onclick="navTo('flights')" id="mobile-flights" class="flex flex-col items-center gap-1 p-2 hover:text-indigo-600 w-full"><i class="fas fa-list text-lg"></i> Board</button>
                    <button onclick="navTo('settings')" id="mobile-settings" class="flex flex-col items-center gap-1 p-2 hover:text-indigo-600 w-full"><i class="fas fa-cog text-lg"></i> Settings</button>
                </nav>
            </main>
        </div>
    </div>

    <!-- FLIGHT DETAIL MODAL -->
    <div id="flightDetailModal" class="hidden fixed inset-0 z-[200] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/80 backdrop-blur-sm transition-opacity" onclick="closeDetailModal()"></div>
        <div class="bg-white w-full max-w-sm rounded-2xl shadow-2xl overflow-hidden relative z-10 fade-in transform transition-all mx-4">
            <div id="modalHeader" class="bg-slate-900 p-6 text-white relative">
                <button onclick="closeDetailModal()" class="absolute top-4 right-4 text-white/70 hover:text-white p-2"><i class="fas fa-times text-xl"></i></button>
                <div class="flex justify-between items-start">
                    <div><div class="text-3xl font-bold font-mono" id="modalTime">--:--</div><div class="text-sm opacity-80" id="modalDate">Scheduled</div></div>
                    <div id="modalBadge"></div>
                </div>
            </div>
            <div class="p-6">
                <div class="flex items-center justify-between mb-6 pb-6 border-b border-slate-100">
                    <div class="text-center"><div class="text-2xl font-bold text-slate-800" id="modalOrigCode">AAA</div><div class="text-xs text-slate-500">Origin</div></div>
                    <div class="text-slate-300 text-xl"><i class="fas fa-plane"></i></div>
                    <div class="text-center"><div class="text-2xl font-bold text-slate-800" id="modalDestCode">BBB</div><div class="text-xs text-slate-500">Destination</div></div>
                </div>
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-slate-50 p-3 rounded-lg border border-slate-100"><div class="text-xs text-slate-500 uppercase font-bold">Terminal</div><div class="text-xl font-bold text-indigo-600" id="modalTerminal">-</div></div>
                    <div class="bg-slate-50 p-3 rounded-lg border border-slate-100"><div class="text-xs text-slate-500 uppercase font-bold">Gate</div><div class="text-xl font-bold text-indigo-600" id="modalGate">-</div></div>
                </div>
                <div class="space-y-4 text-sm">
                    <div class="flex justify-between border-b border-slate-50 pb-2"><span class="text-slate-500">Flight No</span><span class="font-mono font-bold text-slate-800" id="modalFlightNo">---</span></div>
                    <div class="flex flex-col gap-1 border-b border-slate-50 pb-2">
                        <span class="text-slate-500 text-xs uppercase font-bold">Airline</span>
                        <span class="font-medium text-slate-800 text-lg leading-tight" id="modalAirline">---</span>
                    </div>
                    <div class="flex flex-col gap-1">
                        <span class="text-slate-500 text-xs uppercase font-bold">Destination/Origin</span>
                        <span class="font-medium text-slate-800 text-lg leading-tight" id="modalAirportName">---</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN SCRIPT -->
    <script>
        const POWER_10 = [ { code: 'LHR', name: 'London Heathrow', country: 'ðŸ‡¬ðŸ‡§' }, { code: 'JFK', name: 'New York Kennedy', country: 'ðŸ‡ºðŸ‡¸' }, { code: 'DXB', name: 'Dubai Int.', country: 'ðŸ‡¦ðŸ‡ª' }, { code: 'FRA', name: 'Frankfurt', country: 'ðŸ‡©ðŸ‡ª' }, { code: 'SIN', name: 'Singapore Changi', country: 'ðŸ‡¸ðŸ‡¬' }, { code: 'HND', name: 'Tokyo Haneda', country: 'ðŸ‡¯ðŸ‡µ' }, { code: 'CDG', name: 'Paris Charles de Gaulle', country: 'ðŸ‡«ðŸ‡·' }, { code: 'AMS', name: 'Amsterdam Schiphol', country: 'ðŸ‡³ðŸ‡±' }, { code: 'LAX', name: 'Los Angeles Int.', country: 'ðŸ‡ºðŸ‡¸' }, { code: 'CPH', name: 'Copenhagen', country: 'ðŸ‡©ðŸ‡°' } ];
        let state = { currentView: 'dashboard', currentAirport: null, flightData: { departures: [], arrivals: [] }, airportDb: {}, airlineDb: {} };

        // --- UI LOGIC ---
        function openLoginModal() { document.getElementById('landingLoginModal').classList.remove('hidden'); }
        function closeLoginModal() { document.getElementById('landingLoginModal').classList.add('hidden'); }
        function switchToApp() { document.getElementById('landingView').style.display = 'none'; document.getElementById('appContainer').classList.remove('hidden'); }
        function backToLanding() { document.getElementById('appContainer').classList.add('hidden'); document.getElementById('landingView').style.display = 'block'; state.currentView = 'dashboard'; navTo('dashboard'); }

        // Load Databases
        window.addEventListener('load', async () => {
            renderDashboard();
            try {
                // Airports
                const resA = await fetch('https://raw.githubusercontent.com/algolia/datasets/master/airports/airports.json');
                const dataA = await resA.json();
                dataA.forEach(a => { if(a.iata_code) state.airportDb[a.iata_code] = a.city; });
                
                // Airlines
                const resB = await fetch('https://raw.githubusercontent.com/npow/airline-codes/master/airlines.json');
                const dataB = await resB.json();
                dataB.forEach(a => { if(a.iata) state.airlineDb[a.iata] = a.name; });
            } catch(e) {}
        });

        function handleLogin(e) {
            e.preventDefault(); const btn = e.target.querySelector('button'); btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Authenticating...';
            setTimeout(() => { closeLoginModal(); switchToApp(); btn.innerHTML = 'Log In'; }, 800);
        }

        function navTo(view) {
            state.currentView = view;
            ['dashboard', 'flights', 'settings'].forEach(v => {
                document.getElementById(`view-${v}`).classList.add('hidden');
                const dBtn = document.getElementById(`nav-${v}`); const mBtn = document.getElementById(`mobile-${v}`);
                if(view === v) { 
                    dBtn.classList.remove('text-slate-400','hover:bg-slate-800'); dBtn.classList.add('bg-indigo-600','text-white'); 
                    mBtn.classList.add('text-indigo-600');
                } else { 
                    dBtn.classList.add('text-slate-400','hover:bg-slate-800'); dBtn.classList.remove('bg-indigo-600','text-white'); 
                    mBtn.classList.remove('text-indigo-600');
                }
            });
            document.getElementById(`view-${view}`).classList.remove('hidden');
        }

        function renderDashboard() {
            const container = document.getElementById('dashboardGrid');
            if(container) container.innerHTML = POWER_10.map(hub => `<div onclick="selectAirport('${hub.code}', '${hub.name}')" class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm hover:shadow-md hover:border-indigo-300 cursor-pointer transition group"><div class="flex justify-between items-start mb-2"><span class="text-2xl">${hub.country}</span><span class="font-mono text-xs font-bold text-slate-400 bg-slate-100 px-2 py-1 rounded group-hover:bg-indigo-100 group-hover:text-indigo-600 transition">${hub.code}</span></div><h3 class="font-bold text-slate-800 text-sm leading-tight">${hub.name}</h3><div class="mt-3 text-xs text-indigo-600 font-medium opacity-0 group-hover:opacity-100 transition flex items-center gap-1">View Board <i class="fas fa-arrow-right"></i></div></div>`).join('');
        }

        function selectAirport(code, name) { state.currentAirport = { code, name }; document.getElementById('boardTitle').textContent = name; document.getElementById('boardCode').textContent = code; navTo('flights'); refreshData(); }

        function switchFlightTab(type) {
            const tDep = document.getElementById('tab-departures'); const tArr = document.getElementById('tab-arrivals');
            if(type === 'departures') { tDep.classList.replace('text-slate-500', 'text-indigo-600'); tDep.classList.replace('border-transparent', 'border-indigo-600'); tArr.classList.replace('text-indigo-600', 'text-slate-500'); tArr.classList.replace('border-indigo-600', 'border-transparent'); renderFlightTable('departures'); } 
            else { tArr.classList.replace('text-slate-500', 'text-indigo-600'); tArr.classList.replace('border-transparent', 'border-indigo-600'); tDep.classList.replace('text-indigo-600', 'text-slate-500'); tDep.classList.replace('border-indigo-600', 'border-transparent'); renderFlightTable('arrivals'); }
        }

        async function refreshData() {
            if(!state.currentAirport) return;
            const loader = document.getElementById('loadingOverlay'); loader.classList.remove('hidden');
            const apiKey = document.getElementById('settingApiKey').value; const iata = state.currentAirport.code;
            try {
                const [depRes, arrRes] = await Promise.all([ fetch(`https://airlabs.co/api/v9/schedules?dep_iata=${iata}&api_key=${apiKey}`), fetch(`https://airlabs.co/api/v9/schedules?arr_iata=${iata}&api_key=${apiKey}`) ]);
                const depData = await depRes.json(); const arrData = await arrRes.json();
                if(depData.error) throw new Error(depData.error.message);
                state.flightData.departures = depData.response || []; state.flightData.arrivals = arrData.response || [];
                document.getElementById('boardTime').textContent = `Updated: ${new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}`;
                renderFlightTable('departures'); switchFlightTab('departures');
            } catch (err) { document.getElementById('flightTableContainer').innerHTML = `<div class="p-8 text-center text-red-500"><i class="fas fa-exclamation-triangle text-2xl mb-2"></i><p>${err.message}</p><button onclick="navTo('settings')" class="mt-4 text-xs underline">Check API Key</button></div>`; } finally { loader.classList.add('hidden'); }
        }

        function renderFlightTable(type) {
            const container = document.getElementById('flightTableContainer');
            const rawData = type === 'departures' ? state.flightData.departures : state.flightData.arrivals;
            const hidePast = document.getElementById('settingHidePast').checked; const demoMode = document.getElementById('settingDemoMode').checked; const now = new Date();

            let flights = rawData.filter(f => {
                if(!hidePast) return true;
                const t = type === 'departures' ? (f.dep_estimated || f.dep_time) : (f.arr_estimated || f.arr_time);
                if(!t) return true;
                return new Date(t).getTime() > (now.getTime() - (15 * 60000));
            }).sort((a,b) => {
                const tA = type === 'departures' ? (a.dep_time || '') : (a.arr_time || '');
                const tB = type === 'departures' ? (b.dep_time || '') : (b.arr_time || '');
                return tA.localeCompare(tB);
            });

            if(flights.length === 0) { container.innerHTML = `<div class="p-12 text-center text-slate-400">No active ${type} found.</div>`; return; }

            let html = `
                <table class="w-full text-sm text-left">
                    <thead class="text-xs text-slate-500 uppercase bg-slate-50 border-b border-slate-100 sticky top-0">
                        <tr>
                            <th class="px-4 py-3 font-semibold w-16">Time</th>
                            <th class="px-2 py-3 font-semibold w-20">Flight</th>
                            <th class="px-4 py-3 font-semibold text-right sm:text-left">${type === 'departures' ? 'Dest' : 'Origin'}</th>
                            <!-- Gate and Status hidden on small mobile, visible on sm+ -->
                            <th class="px-4 py-3 font-semibold hidden sm:table-cell">Gate</th>
                            <th class="px-6 py-3 font-semibold text-right hidden sm:table-cell">Status</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-100">
            `;

            flights.forEach((f, idx) => {
                const d = extractData(f, type, demoMode);
                const badge = getStatusBadge(d.status, d.delay);
                let locName = d.airportCode;
                if(state.airportDb[d.airportCode]) locName = state.airportDb[d.airportCode];

                html += `
                    <tr class="hover:bg-indigo-50/30 transition-colors cursor-pointer" onclick="openFlightDetail('${type}', ${idx})">
                        <td class="px-4 py-4 font-bold text-slate-700 whitespace-nowrap text-sm">${d.time}</td>
                        <td class="px-2 py-4"><div class="font-mono font-bold text-indigo-600 text-xs">${d.number}</div></td>
                        <td class="px-4 py-4 text-right sm:text-left">
                            <div class="font-medium text-slate-700 truncate max-w-[120px] ml-auto sm:ml-0 text-sm">${locName}</div>
                            <div class="text-xs text-slate-400 sm:hidden">${d.airline}</div>
                        </td>
                        <td class="px-4 py-4 hidden sm:table-cell"><span class="font-mono font-bold ${d.sim ? 'text-indigo-400' : 'text-slate-700'}">${d.gate || '-'}</span></td>
                        <td class="px-6 py-4 text-right hidden sm:table-cell">${badge}</td>
                    </tr>
                `;
            });
            html += `</tbody></table>`;
            container.innerHTML = html;
        }

        // --- FLIGHT DETAIL MODAL ---
        function openFlightDetail(type, index) {
            const f = type === 'departures' ? state.flightData.departures[index] : state.flightData.arrivals[index];
            const demoMode = document.getElementById('settingDemoMode').checked;
            const d = extractData(f, type, demoMode);
            document.getElementById('modalTime').textContent = d.time;
            document.getElementById('modalDate').textContent = d.status;
            document.getElementById('modalBadge').innerHTML = getStatusBadge(d.status, d.delay);
            if(type === 'departures') { document.getElementById('modalOrigCode').textContent = state.currentAirport.code; document.getElementById('modalDestCode').textContent = d.airportCode; } 
            else { document.getElementById('modalOrigCode').textContent = d.airportCode; document.getElementById('modalDestCode').textContent = state.currentAirport.code; }
            document.getElementById('modalTerminal').textContent = d.terminal || '-';
            document.getElementById('modalGate').textContent = d.gate || '-';
            if(d.sim) document.getElementById('modalGate').innerHTML += ' <i class="fas fa-magic text-xs ml-1 text-slate-300"></i>';
            document.getElementById('modalFlightNo').textContent = d.number;
            document.getElementById('modalAirline').textContent = d.airline;
            let locName = d.airportCode;
            if(state.airportDb[d.airportCode]) locName = state.airportDb[d.airportCode];
            document.getElementById('modalAirportName').textContent = locName;
            document.getElementById('flightDetailModal').classList.remove('hidden');
            document.body.classList.add('modal-active');
        }
        function closeDetailModal() { document.getElementById('flightDetailModal').classList.add('hidden'); document.body.classList.remove('modal-active'); }

        // --- HELPERS ---
        function extractData(f, type, demo) {
            let data = { time: '--:--', number: f.flight_iata || '---', airline: f.airline_iata || '', airportCode: '???', gate: null, terminal: null, status: f.status || 'Scheduled', delay: 0, sim: false };
            if(type === 'departures') {
                data.airportCode = f.arr_iata || f.arr_icao; const rawT = f.dep_estimated || f.dep_time;
                if(rawT) data.time = rawT.substring(11, 16);
                data.gate = f.dep_gate; data.terminal = f.dep_terminal;
                if(f.dep_estimated && f.dep_time) data.delay = Math.round((new Date(f.dep_estimated) - new Date(f.dep_time))/60000);
            } else {
                data.airportCode = f.dep_iata || f.dep_icao; const rawT = f.arr_estimated || f.arr_time;
                if(rawT) data.time = rawT.substring(11, 16);
                data.gate = f.arr_gate; data.terminal = f.arr_terminal;
                if(f.arr_estimated && f.arr_time) data.delay = Math.round((new Date(f.arr_estimated) - new Date(f.arr_time))/60000);
            }
            if(demo && !data.gate) { data.gate = ['A','B','C'][Math.floor(Math.random()*3)] + Math.floor(Math.random()*20); data.terminal = Math.floor(Math.random()*3) + 1; data.sim = true; }
            
            // Full Airline Name
            if(state.airlineDb[data.airline]) data.airline = state.airlineDb[data.airline];
            
            return data;
        }

        function getStatusBadge(status, delay) {
            let color = 'bg-slate-100 text-slate-600'; let icon = 'fa-clock'; let text = status;
            const s = String(status).toLowerCase();
            if(s === 'landed') { color = 'bg-emerald-50 text-emerald-700'; icon = 'fa-check'; }
            if(s === 'active') { color = 'bg-blue-50 text-blue-700'; icon = 'fa-plane'; text = 'In Air'; }
            if(s === 'cancelled') { color = 'bg-red-50 text-red-700'; icon = 'fa-ban'; }
            if(delay > 10) { color = 'bg-amber-50 text-amber-700'; icon = 'fa-exclamation'; text += ` +${delay}m`; }
            return `<span class="${color} border border-transparent px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wide whitespace-nowrap"><i class="fas ${icon} mr-1"></i> ${text}</span>`;
        }
    </script>
</body>
</html>
